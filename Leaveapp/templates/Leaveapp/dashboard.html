{% extends 'base.html' %}
{% block content %}
{% load guardian_tags %}
{% load custom_tags %}

<h2><center>TWX Dashboard</center></h2>
<div class="row">
  <div class="col-4">

	  <form action="{% url 'twx:application-create' %}">
         <button type="submit" class="btn btn-primary">New Application</button>
      </form> 
	  </div>
  <div class="col-4"></div>
  <div class="col-4">
	<div class="form-group" style="display: flex">      
		<label for="sel1">Search by:</label>
		  <select class="form-control" id="sel1" name="sellist1">
			<option>Date</option>
			<option>Applicant</option>
			<option>Purpose</option>
			<option>Amount</option>
			<option>Document</option>
		  </select>
	   <label for="comment">With keyword:</label>
		 <textarea class="form-control" rows="1" id="comment"></textarea>
	</div>
  </div>
</div>
<table class="table table-bordered table-sm">
  <thead class="thead-dark">
	  <tr>
		<th>Date</th>
		<th>Applicant</th>
		<th>Purpose</th>
		<th>Amount</th>
		<th>Document</th>
		<th>Approval Status</th>
		<th>Actions</th>
	  </tr>
  <thead>

	  


  {% for item in application %}
  	{% get_obj_perms request.user for item as "permission" %}
	  <tr>
		{% if "can_cancel" in permission %} 
		<td>{{item.created_on}}</td>
		<td>{{item.created_by}}</td>
		<td>{{item.purpose}}</td>
		<td>{{item.amount}}</td>
		<td><a href="some.pdf">quotation</a></td>
		<td>{% textify_status item.status %} by {{ item.modified_by }}</td>
		{% if item.status == 4 or item.status == 1 %}
			<td><a href="{% url 'twx:application-update' item.pk %}" class="btn btn-primary">Revise</a><a href="{% url 'twx:application-delete' item.pk %}" class="btn btn-primary">Cancel</a></td>
		{% endif %}
		{% elif "can_check" in permission %}
		 {% if item.status == 1 or item.status == 2 %}
			<td>{{item.created_on}}</td>
			<td>{{item.created_by}}</td>
			<td>{{item.purpose}}</td>
			<td>{{item.amount}}</td>
			<td><a href="some.pdf">quotation</a></td>
			<td>{% textify_status item.status %} by {{ item.modified_by }}</td>
			<td><form action="{% url 'twx:application-detail' item.pk %}"><button type="btn" class="btn btn-primary">Open to Check</button></form></td>
			{% endif %}
		{% elif "can_approve" in permission %} 
		  {% if item.status == 3 or item.status == 5 %}
			<td>{{item.created_on}}</td>
			<td>{{item.created_by}}</td>
			<td>{{item.purpose}}</td>
			<td>{{item.amount}}</td>
			<td><a href="some.pdf">quotation</a></td>
			<td>{% textify_status item.status %} by {{ item.modified_by }}</td>
			{%if item.status == 3 %}
			<td><form action="{% url 'twx:application-detail' item.pk %}"><button type="btn" class="btn btn-primary">Open to Check</button></form></td>
		    {% endif %}
		 {% endif %}
	{% endif %}
	  </tr>
  {% endfor %}

</table>

<div class="container">                
  <ul class="pagination justify-content-center">
    <li class="page-item"><a class="page-link" href="javascript:void(0);">Previous</a></li>
    <li class="page-item"><a class="page-link" href="javascript:void(0);">1</a></li>
    <li class="page-item"><a class="page-link" href="javascript:void(0);">2</a></li>
    <li class="page-item"><a class="page-link" href="javascript:void(0);">Next</a></li>
  </ul>
</div>

{% endblock %}
